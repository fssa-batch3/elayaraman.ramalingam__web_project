<!DOCTYPE html>
<html lang="en">
    <head>
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        
        <title>Regitration</title>
        <link rel="stylesheet" href="../../assets/css/Reg/form.css">
        <link rel="stylesheet" href="../../assets/css/Reg/font.css">
        <link rel="shortcut icon" href="../../assets/images/logo.png" type="image/x-icon">


    </head>
    <body>
        <div class="form">
            <form id="form" role="form" onsubmit="sign_up(event)" autocomplete="off">
                <h1>Registration</h1>
                
                <div class="form_data">
                    <label for="name">Name</label>
                    <input type="text" name="name" id="name" placeholder="enter your name"  required>
                </div>

                <div class="form_data">
                    <label for="tel">Ph No</label>
                    <input type="tel" name="tel" id="tel" placeholder="enter your phone no" required >
                </div>

                <div class="form_data">
                    <label for="date">D/O/B</label>
                    <input placeholder="Date of Birth" type="text" onfocus="(this.type = 'date')"  id="date" name="date" required>
                </div>

                <div class="form_data">
                    <label for="new-password">Enter the Password</label>
                    <input type="password" name="new-password" id="new-password" placeholder="Enter the Password" required>
                </div>

                <div class="form_data">
                    <label for="confirm-password">Confirm the Password</label>
                    <input type="password" name="confirm-password" id="confirm-password" placeholder="Confirm the Password" required >
                </div>

                <div class="btn_holder">
                    <button type="submit" class="btn_2 btn1 link" onclick="history.back()">
                        back
                    </button>
                    <button type="submit" class="btn_2 btn1" onclick="createUser()">
                        Submit
                    </button>
                </div>
            </form>
            
        </div>
        <script>

            function createUser(){
                
                let user_name   =   document.getElementById("name").value;
                let user_ph     =   document.getElementById("tel").value;
                let user_dob    =   document.getElementById("date").value;
                let new_passwd  =   document.getElementById("new-password").value;
                let user_passwd =   document.getElementById("confirm-password").value;

                let user_data = new Array();

                user_data = JSON.parse(localStorage.getItem("users"))?JSON.parse(localStorage.getItem("users")):[]

                if(user_data.some((v)=>{return v.user_ph==user_ph}))
                {
                    alert("This number is already linked with another account");
                    window.location.href = "./reg.html";
                }
                else
                {
                    user_data.push({
                        "user_name": user_name,
                        "user_ph": user_ph,
                        "user_dob": user_dob,
                        "user_passwd": user_passwd
                    })

                    alert("account created for this mobile number");
                    window.location.href="./login.html";
                    localStorage.setItem("users",JSON.stringify(user_data));
                }
            }


        </script>
    </body>
</html