<!DOCTYPE html>
<html lang="en">
    <head>
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        
        <title>Regitration</title>
        <link rel="stylesheet" href="../../assets/css/Reg/form.css">
        <link rel="stylesheet" href="../../assets/css/Reg/font.css">
        <link rel="shortcut icon" href="../../assets/images/logo.png" type="image/x-icon">


    </head>
    <body>
        <div class="form">
            <form id="form" autocomplete="on"  onsubmit="">
                <h1>Registration</h1>
                
                <div class="form_data">
                    <label for="name">Name</label>
                    <input type="text" name="username" id="username" placeholder="enter your name"  required>
                </div>

                <div class="form_data">
                    <label for="tel">Phone No</label>
                    <input type="tel" name="tel" id="tel" placeholder="enter your phone no" required >
                </div>

                <div class="form_data">
                    <label for="new-password">Enter the Password</label>
                    <input type="password" name="new-password" id="new-password" placeholder="Enter the Password" autocomplete="off" required>
                </div>

                <div class="form_data">
                    <label for="confirm_password">Confirm the Password</label>
                    <input type="password" name="confirm_password" id="confirm_password" placeholder="Confirm the Password" autocomplete="off" required>
                </div>

                <div class="btn_holder">
                    <button class="btn_2 btn1 link" onclick="window.history.back()">
                        back
                    </button>
                    <button type="submit" class="btn_2 btn1">
                        Submit
                    </button>
                </div>
            </form>
            
        </div>
        <script>
                        // function signup(e){
                            const form = document.querySelector("#form");

                            form.addEventListener("submit", function(event) {
                            event.preventDefault();
                            console.log("username");

                            const formData = new FormData(form);
                            let registrationData = [];

                            // Input validation

                            if (!formData.get("username")) {
                                alert("Username is required");
                                return;
                            }
                            

                            if (!formData.get("tel")) {
                                alert("tel is required");
                                return;
                            }

                            if (!formData.get("confirm_password")) {
                                alert("Password is required");
                                return;
                            }

                            if (localStorage.getItem("registrationData")) {
                            registrationData = JSON.parse(localStorage.getItem("registrationData"));

                            for (let i = 0; i < registrationData.length; i++) {
                            if (formData.get("tel") === registrationData[i].tel) {
                                alert("User already exists");
                                return;
                            }
                            }
                            }

                            if(formData.get("new-password") !== formData.get("confirm_password")){
                                alert("both passwords should be same");
                                return;
                            }

                            // Password validation
                            if (formData.get("confirm_password").length < 8) {
                                alert("Password must be at least 8 characters long");
                                return;
                            }
                            // Space validation
                            if (formData.get("username").indexOf(" ") !== -1) {
                                alert("Username cannot start with spaces");
                                return;
                            }

                            if (formData.get("username").lastIndexOf(" ") !== -1) {
                                alert("Username cannot end with spaces");
                                return;
                            }

                            if (formData.get("tel").indexOf(" ") !== -1) {
                                alert("Phone number cannot contain spaces");
                                return;
                            }

                            if (formData.get("tel").lastIndexOf(" ") !== -1) {
                                alert("Phone number cannot contain spaces");
                                return;
                            }

                            if (formData.get("confirm_password").indexOf(" ") !== -1) {
                                alert("Password cannot begin with spaces");
                                return;
                            }

                            if (formData.get("confirm_password").lastIndexOf(" ") !== -1) {
                                alert("Password cannot end with spaces");
                                return;
                            }

                            // Check if the data already exists in local storage
                            if (localStorage.getItem("registrationData")) {
                                registrationData = JSON.parse(localStorage.getItem("registrationData"));
                            }

                            // Push the new data to the array
                            registrationData.push({
                                username: formData.get("username"),
                                tel: formData.get("tel"),
                                password: formData.get("confirm_password")
                            });

                            // Store the array in local storage
                            localStorage.setItem("registrationData", JSON.stringify(registrationData));

                            // go to the login page

                            window.location.href="./login.html";

                            // Clear the form
                            // form.reset();
                            });
                        
        </script>
    </body>
</html